title: Lot60-BLE 键盘使用说明
category: 教程

time: 1567123076035
---
# 概述

Lot60-BLE 是一款低功耗蓝牙双模键盘。其固件底层使用了TMK作为键盘功能核心，几乎完全实现了TMK功能[^1]。其采用了与GH60完全一致的按键阵列，使其配列文件与GH60几乎完全兼容[^3]。

## LED 一览
Lot60-BLE 包含了1个CapsLock LED，和一个RGB LED 状态指示灯（或3个单色LED状态指示灯）。

RGB 状态指示灯位于Esc按键处，使用贴片的LED灯，故需要使用RGB轴。

如果不想使用RGB轴，可以放弃这个LED灯，转而使用位于按键1, 2, 3处的LED指示灯。

# 使用手册

## 快速入门
1. （如果购买的是散件）按照线路板上的标识，将两个芯片焊接到线路板上，并焊接USB口。
2. 使用USB线连接到你的电脑。如果电脑能够成功的识别到名为“Lot60-BLE”的设备，说明USB芯片工作正常。这时用镊子尝试短路任意一个按键，观察是否有按键输入。若有按键输入，则说明整块键盘工作正常。
3. 如果你想使用3个状态指示灯而不是一个RGB状态指示灯，那么请拆除正面的RGB指示灯。
4. 组装你的键盘。注意要先装定位板，再装轴哦~
5. 将电池连接到键盘背面的电池接口。注意正负极不要装反，否则可能会导致键盘烧毁。
6. 好了，你的Lot60-BLE键盘已经组装完成了。插上USB尝试一下吧！

## 默认配列

![默认配列图](/raw/lot60-ble/keymap.png)

## 操作说明

### 开机

同时按下`Space(空格)+E`，直到LED指示灯亮起即可开机。

插入USB的同时键盘会自动开机。

### 蓝牙连接设备

在键盘开机的状态下，使用你要连接设备的蓝牙搜索功能搜索蓝牙设备。你会见到一个叫做`BLE60-Rev.E_XXXXXX`或`Lot60-BLE_XXXXXX`的设备，使用设备连接，并按设备提示在键盘上输入配对码即可。

### USB 连接设备

直接将USB线缆插入到键盘的USB接口，键盘即自动切换至USB模式。这时候就可以使用USB模式输入了。

### USB/蓝牙状态切换

在默认配列下，按下Fn0+Tab，即可在USB和蓝牙两种模式下切换。

### 省电模式

在没有接入USB电源的情况下，键盘处于省电模式。

在省电模式下，所有的指示灯仅在变化后亮起5秒，然后熄灭。键盘在无操作15秒后转入慢速扫描模式，无操作600秒后自动睡眠。

慢速扫描模式下，按键检测将可能略有延迟。在慢速扫描模式下按任意按键即可恢复到快速扫描模式。

自动睡眠后，按下键盘的任意按键即可再次唤醒。

### 电量显示

在新版本的iOS、安卓和Windows上，应该能够正确的显示蓝牙设备的电量百分比。

由于测量方式可能有误差，电量百分比可能无法达到100%或者低至0%，这是正常现象。电量百分比仅供参考。

对于安卓手机，如果没有正确的显示电量，可以尝试下载BatON软件来获取蓝牙设备电量。

### RGB 颜色说明

注意显示的颜色可能和实际颜色有略微色差

- <span style="color: #FFFFFF">■</span>白色：无连接
- <span style="color: #66CCFF">■</span>天依蓝：蓝牙已连接
- <span style="color: #0099FF">■</span>天蓝色：USB已连接
- <span style="color: #FF8000">■</span>橙色：充电中
- <span style="color: #00FF00">■</span>绿色：充电完毕
- <span style="color: #FFFF00">■</span>黄色：输入配对密码
- <span style="color: #FF0080">■</span>紫红色：配对密码输入完毕
- <span style="color: #FF00FF">■</span>紫色：休眠

### 手动休眠

在默认配列下，按下Fn0+CapsLock，即可让键盘进入休眠状态。

手动休眠后，需要手工按下`Space+U`才能再次唤醒。

### 删除绑定

若想要连接到其他的蓝牙设备，或蓝牙连接不正常，则可尝试删除绑定。

先手动休眠键盘，然后在开机时按下`Space+E`即可删除绑定。（即在休眠后，按下Space+U+E开机）

### 全键无冲（NKRO）

此键盘支持NKRO（全键无冲）模式，但默认不启用全键无冲。全键无冲仅在USB模式下才可使用。

在键盘开机时按下`Space+N`（即在休眠后，按下Space+U+N开机），即可切换全键无冲的状态。

### 其他功能键（BootMagic）

以下是所有的开机时功能键的列表，你可以在开机时同时按下Space+下面的键来实现对应的功能。

需要注意的是，下面的按键全部都指的是当前配列的第0层按键。如果你更改了配列，那么这些按键的位置可能会发生变化。

- E: 擦除蓝牙绑定
- Esc：跳过Bootmagic
- Backspace：重置eeconfig
- B: 进入Bootloader
- D：切换Debug模式
  - X：切换阵列Debug模式
  - K：切换键盘Debug模式
  - M：切换鼠标Debug模式
- LCtrl：交换capslock和左ctrl
- CapsLock: 将capslock用作ctrl
- LAlt：交换LAlt和LGUI
- RAlt: 交换RAlt和RGUI
- LGUI：禁用GUI按钮
- `(1左边那个, Grave): 交换Esc和Grave
- \: 交换\和Backspace
- N：切换NKRO状态
- 0~7：设置默认层为对应数字的层

### 更改配列

在这里，我假设你已经熟悉如何使用 [Keyboard layout editor](https://www.keyboard-layout-editor.com/) 和 [TMK Keymap Generator](https://tools.lotlab.org/tkg/) 来创建适用于键盘的配列了。

因这个键盘含有额外的两项功能键（即切换设备和睡眠），故通常的TKG无法满足要求。请使用上面给出的链接中的TKG，里面包含了这块自定义键盘的额外两颗功能按键。

在TKG中配置好配列并点击下载配列，将配列的eep文件下载后，将键盘使用USB连接到电脑。打开 [配列下载工具(KeymapDownloader.exe)](https://github.com/Lotlab/nrf52-keyboard/releases) ，选择你的键盘和配列，点击下载，即可将新的配列下载到键盘中。

### 固件更新

你可能需要升级固件来获得新功能或者修复已有的BUG，可供更新的固件可以在页面最下方的固件发布处找到。

此键盘的固件分为蓝牙固件和USB固件。蓝牙固件的文件名形如`keyboard_nrf52_date_version.zip`，USB固件的文件名形如`keyboard_ch554_date_version.hex`。

请注意，蓝牙固件和USB固件必须更新至同一个版本，否则USB将会工作不正常。若当前版本的固件没有提供USB固件，则可以不用更新USB固件。

#### 更新蓝牙固件

> **刷入不正确的固件可能会使得你的键盘损坏！**
>
> 请在升级前确认升级包是由可信的人员提供的。
>
> 升级包可能包含程序(Application)和引导程序(Boot Loader)，刷入错误的引导程序将会使DFU功能完全不可用。在这种情况下，您必须使用SWD接口烧录正确的蓝牙栈、引导程序和程序，才能使键盘恢复正常工作。
>
> 如果您刷入了错误的程序(Application)而无法进入DFU模式，参考下面的“[如何进入DFU模式](如何进入DFU模式)”来强行刷新。

1. 使用手机下载并打开 nRF Connect[^2] 程序
2. 点击nRF Connect右上角的Scan扫描蓝牙设备，这时候应该能够见到你的蓝牙键盘
4. 点击CONNCET按钮，等待连接成功
5. 点击右上角的DFU按钮，选择第一个Distribution packet(ZIP)，然后选择刚刚下载的固件包
6. 静静的等待升级完毕即可

如果在点击DFU后出现问题，无法继续刷新。可以在[进入DFU模式](#如何进入DFU模式)后尝试以下步骤
3. 点击nRF Connect右上角的Scan扫描蓝牙设备，这时应该会找到一个叫做DfuTarg的蓝牙设备
4. 按照上面的4-6步再做一遍。

刷新完成后可能要手工在手机或电脑上取消配对并重新配对才可继续使用

#### 更新USB固件

> **刷入不正确的USB固件可能使你的键盘的USB功能完全不可用！**
>
> 请在更新前确认此固件是由可信的人员提供的。
>
> 若在更新完毕后发现USB功能不可用，可以参考下面的刷新说明重新刷新。

1. 至WCH官网下载[固件更新工具](http://www.wch.cn/downloads/WCHISPTool_Setup_exe.html)[^5]
2. 打开固件更新工具，切换至“8位ch55x系列”，将芯片型号改为“CH552”[^6]，并在底下的“用户程序文件中”选择你要更新的USB固件
3. 将键盘与电脑连接的USB线断开。按住键盘背面的K1按钮[^7]，再使用USB线连上电脑。听到发现新设备的声音后，即可松开按钮。此时，设备列表中会出现一个可选择的设备并会自动选中。
4. 点击下载按钮。下载完毕后，将键盘的USB断开并重新连接，即可升级完毕。

# 常见问题

## Q&A

### 键盘的功耗与电池容量的选择

此键盘的典型工作功耗为0.4ma[^4]，电池容量与使用时长的关系可以按照以下算法来估计：

> t(天) = C(容量, mah) * 2 / n (每日使用时长,h)
>
> 例如，使用500mah的电池，每日使用10小时的话，键盘约能使用100天。

### 信号改善的方法

蓝牙的信号可能受到多方面因素的影响。你可以尝试以下方法来改善蓝牙信号：

- 使用非金属外壳、非金属定位板与非金属桌面
- 将键盘和主机尽可能的靠近
- 适当降低2.4GHZ的WiFi的发射功率
- 减少空间内其他WiFi和蓝牙设备的存在
- 不要触摸蓝牙模块的天线位置

### 是否支持多媒体键

支持。

系统键（关机、休眠、重启）因使用较少未能测试，若无法使用请联系我。

### 如何判断我的设备是否支持蓝牙4.0

若您在使用手机。如果您的手机使用的是Android5.0及以上系统，或 iOS 7 及以上系统，或 Windows Mobile 10系统，则应当支持蓝牙4.0。

若您在您的计算机上使用Windows。请查看您的设备管理器，寻找“蓝牙 LE”相关字样的设备。建议使用最新版Windows以增加蓝牙使用体验。

MacOS尚未测试，理论上应该支持。

### 如何强制休眠键盘

如果休眠按键不起作用了，那么你可能会需要知道如何强制休眠键盘。

- 方法1：将键盘放置15分钟，其会自动转入休眠状态。

- 方法2：按下键盘背面的RESET按钮，键盘即进入休眠状态。
- 方法3：拔下键盘的USB线和电池，再重新插上。

### 如何进入DFU模式

- 方法1：将键盘休眠。在唤醒的同时按下`Space+B`即可进入DFU模式
- 方法1：则将键盘翻到背面，找到GPIO0接口。使用镊子将其与GND接口短路。将键盘的电池断开并重新连接，或按下RESET按钮使键盘强制重启，此时就应该能够顺利的进入DFU模式了。

### 如何退出DFU模式

在DFU模式下无操作1分半钟后即可自动退出DFU模式。

## 故障排除

### 通用故障排除指南

如果你的键盘遇到了无法正常工作的问题，请按下列步骤进行：

1. 将键盘关机并重新开机。如果遇到了蓝牙方面的问题，则在开机时按下`Space+E`解除绑定。
2. 将键盘使用USB连接到电脑，观察电脑的新增硬件状态和键盘的工作状态指示灯。若电脑提示发现新硬件，并且指示灯提示工作于USB状态的话，则说明主控硬件没有出现问题。
3. 如果遇到了按键不正常的情况，请将键盘关机。重新开机时，按下`Space+BackSpace`重置EEPROM的设定。

### 我的键盘无法开机了

尝试使用USB接入电脑，看看是否能够正常工作？如果可以的话，可能是电池没电了，需要充电。

### 按键部分（全部）混乱了

可能是你刷入了错误的配列，尝试使用配列更新工具重新更新试试？

亦或者是你选择了不正确的默认层。先休眠键盘（如果没法休眠，则可尝试[如何强制休眠键盘](#如何强制休眠键盘)），然后按 `Space+BackSpace` 重置默认层的设定。

### 更新配列后无法正常保存配列

重启后再次更新即可。

### 更新配列后所有按键失效

使用配列下载工具将自定义配列清空，使用内置的配列试试。

### Windows 下出现“驱动程序错误”

请在设备管理器中删除这个设备，取消绑定，重启电脑，并在键盘上删除绑定，然后重新连接试试。

### 有时候出现卡键的问题

这是蓝牙信号不好的原因。请查看上面的蓝牙信号的改善方法来改善蓝牙信号。

# 固件发布

### 1.0.3

此版本是出厂版本的固件。

- 百度云下载




[^1]: 没用实现的TMK功能包括：Command Key(固件空间不够), 鼠标键(EndPoint不够)，以及LED灯效(这个键盘没灯)
[^2]: 可以到 [官方下载页面](http://www.nordicsemi.com/eng/Products/Nordic-mobile-Apps/nRF-Connect-for-mobile-previously-called-nRF-Master-Control-Panel) 或者应用商店搜索下载。支持IOS和安卓端。
[^3]: 几乎完全兼容：两者格式是一致的，但存在部分Fn功能的差异。若直接使用tmk的eep文件，则会造成休眠和设备切换两颗功能键不可用。
[^4]: 典型功耗为0.4ma: 使用万用表，在蓝牙连接且无任何灯光的情况下测得。蓝牙搜索和灯光的启用会增加额外的耗电量，不同的无线环境下也有可能造成功耗的增加。此功耗不代表所有工况下的工作电流，仅供参考。

[^5]: 可以使用[官方的固件更新工具](http://www.wch.cn/downloads/WCHISPTool_Setup_exe.html)。若你在使用Linux，则可以使用三方的[WCHISP](https://github.com/rgwan/librech551)来更新。
[^6]: 部分批次可能使用的是CH554，若无法识别设备，则可尝试更改为CH554进行烧录。
[^7]: K1按钮位于键盘背面的下方偏右位置，即在下方左ALT键的背面附近。若没有焊接此按钮，也可以使用镊子或其他导电的东西短接K1的上下两个脚，用来模拟按钮按下。