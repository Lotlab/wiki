<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Jim Jiang">
    <meta name="description" content="Lotlab Wiki Site">
    <title>
                蓝牙键盘固件更新教程 - Lotlab Wiki            </title>
    <link href="/assets/mui.min.css" rel="stylesheet" type="text/css" />
    <link href="/assets/style.css" rel="stylesheet"/>
    <link href="/assets/octicons/font/octicons.min.css" rel="stylesheet" />
    <script src="/assets/highlight.min.js"></script>
    <script src="/assets/mui.min.js"></script>
</head>
<body>
<header id="header" class="mui--z2">
    <div class="mui-appbar mui--appbar-line-height">
        <div class="mui-container-fluid">
            <a class="sidedrawer-toggle mui--visible-xs-inline-block mui--visible-sm-inline-block js-show-sidedrawer">☰</a>
            <a class="sidedrawer-toggle mui--hidden-xs mui--hidden-sm js-hide-sidedrawer">☰</a>

                            <span class="appbar-brand mui--hidden-xs">蓝牙键盘</span>
                                                         <b class="appbar-brand octicon octicon-chevron-right mui--hidden-xs"></b>
                    <a href="../" class="appbar-brand mui--hidden-xs"></a>
                                <b class="appbar-brand octicon octicon-chevron-right mui--hidden-xs"></b>
                <span class="appbar-brand mui--hidden-xs">蓝牙键盘固件更新教程</span>
                <span class="mui--text-title appbar-brand mui--visible-xs-inline-block">Lotlab Wiki</span>
                    </div>
    </div>
</header>
<div id="sidedrawer" class="mui--no-user-select">
    <div id="sidedrawer-brand" class="mui--appbar-line-height">
        <a href="/" class="mui--text-title" target="_self">Lotlab Wiki</a>
    </div>
    <div class="mui-divider"></div>
    <ul>
                <li>
    <strong class="fold">蓝牙键盘</strong>
    <ul>
                <li>
            <a href="/page/ble4100/" target="_self">
                BLE4100套件使用说明            </a>
        </li>
                <li>
            <a href="/page/lkb-core/" target="_self">
                LKB-Core使用说明            </a>
        </li>
                <li>
            <a href="/page/lot60-ble/" target="_self">
                Lot60-BLE 键盘使用说明            </a>
        </li>
                <li>
            <a href="/page/ble4100/advanced/" target="_self">
                BLE4100高级资源            </a>
        </li>
                <li>
            <a href="/page/bluetooth/build-guide/" target="_self">
                LotKB固件编译移植指南            </a>
        </li>
                <li>
            <a href="/page/bluetooth/upgrade/" target="_self">
                蓝牙键盘固件更新教程            </a>
        </li>
            </ul>
</li>
<li>
    <strong class="fold">教程</strong>
    <ul>
                <li>
            <a href="/page/gh60-related/" target="_self">
                GH60相关            </a>
        </li>
                <li>
            <a href="/page/kms-activation/" target="_self">
                KMS激活            </a>
        </li>
                <li>
            <a href="/page/lcd2usb/" target="_self">
                LCD2USB使用说明            </a>
        </li>
            </ul>
</li>
<li>
    <strong class="fold">站务</strong>
    <ul>
                <li>
            <a href="/page/terms/" target="_self">
                协议            </a>
        </li>
            </ul>
</li>
                <li>
    		<strong>其他链接</strong>
	    <ul>
                    <li><a href="https://github.com/Lotlab/wiki" target="_blank">Github</a></li>
                    <li><a href="http://shop.lotlab.org" target="_blank">LotShop</a></li>
                    <li><a href="/changelog">更新日志</a></li>
            </ul>
    </li>
    </ul> 
</div><div id="content-wrapper">
<!-- Main content goes here -->
<div class="mui--appbar-height"></div>
<div class="mui-container-fluid mui-col-sm-10 mui-col-sm-offset-1">
<br>
<h1 class="page-title">
蓝牙键盘固件更新教程<div class="category mui--pull-right">
<span class="label label-primary">蓝牙键盘</span>
<span id="/page/bluetooth/upgrade/" class="leancloud_visitors label label-primary">
<em class="post-meta-item-text">阅读量 </em>
<i class="leancloud-visitors-count">N/A</i>
</span>
</div>
</h1>
<div class="mui-panel mui--hidden-md mui--hidden-xs mui--hidden-sm" id="toc">
<div class="toc-heading">
<h4>目录</h4>
<a id="toc-hide" href="#">隐藏</a>
</div>
</div>
<div class="row" id="article">
<h2><a href="#概述" name="概述" target="_self" class="anchor"><span class="header-link">#</span></a>&nbsp;概述</h2>
<p>你可能需要升级固件来获得新功能或者修复已有的 BUG，可供更新的固件可以在产品页面最下方的固件发布处找到。</p>
<p>此系列键盘的固件一般分为蓝牙固件和 USB 固件。蓝牙固件的文件名形如<code>[键盘名称]_nrf52_[编译日期]_[Git版本].zip</code>，USB 固件的文件名形如<code>[键盘名称]_ch554_[编译日期]_[Git版本].hex</code>。</p>
<p>USB 固件和蓝牙固件有着一一对应的关系，必须同时更新。如果当前固件版本没有包含 USB 固件或蓝牙固件，则可以只更新一个。如果你在进行跨版本升级，请确认两个固件都升级到最后发布的版本。</p>
<h2><a href="#更新蓝牙固件" name="更新蓝牙固件" target="_self" class="anchor"><span class="header-link">#</span></a>&nbsp;更新蓝牙固件</h2>
<h3><a href="#更新警告" name="更新警告" target="_self" class="anchor"><span class="header-link">#</span></a>&nbsp;更新警告</h3>
<ul>
<li><strong>刷入不正确的固件可能会使得你的键盘损坏！</strong></li>
<li>请在更新前确认升级包是由可信的人员提供的。</li>
<li>请在更新前阅读固件发布页面的详细说明，了解可能出现的问题；</li>
<li>升级包可能包含蓝牙栈 (SoftDevice) 或引导程序(Bootloader)，刷入错误的蓝牙栈或引导程序将会使固件更新功能完全不可用。在这种情况下，您必须使用 SWD 接口烧录正确的蓝牙栈、引导程序和程序，才能使键盘恢复正常工作。</li>
<li>如果您刷入了错误的程序 (Application) 而无法进入 DFU 模式，请参考产品页面的相关说明，<strong>强行进入 DFU 模式</strong>然后更新。</li>
</ul>
<h3><a href="#通常更新方法" name="通常更新方法" target="_self" class="anchor"><span class="header-link">#</span></a>&nbsp;通常更新方法</h3>
<ol>
<li>使用手机安装并打开 nRF Connect<sup class="footnote-ref"><a href="#fn1" id="fnref1" target="_self">[1]</a></sup> 程序</li>
<li>点击 nRF Connect 右上角的 Scan 扫描蓝牙设备，这时候应该能够见到你的蓝牙键盘</li>
<li>点击 CONNCET 按钮，等待连接成功</li>
<li>点击右上角的 DFU 按钮，选择第一个 Distribution packet(ZIP)，然后选择刚刚下载的蓝牙固件包</li>
<li>静静的等待升级完毕即可</li>
</ol>
<p>刷新完成后可能要手工在手机或电脑上取消配对并重新配对才可继续使用</p>
<h3><a href="#特殊更新方法" name="特殊更新方法" target="_self" class="anchor"><span class="header-link">#</span></a>&nbsp;特殊更新方法</h3>
<p>如果在点击 DFU 后出现问题，无法继续刷新。可以在请参考产品页面的相关说明，<strong>进入 DFU 模式</strong>后尝试以下步骤。</p>
<ol>
<li>点击 nRF Connect 右上角的 Scan 扫描蓝牙设备，这时应该会找到一个叫做 DfuTarg 的蓝牙设备</li>
<li>按照上面的 3-5 步再做一遍。</li>
</ol>
<h3><a href="#常见问题" name="常见问题" target="_self" class="anchor"><span class="header-link">#</span></a>&nbsp;常见问题</h3>
<ol>
<li>Q: 我在点击 DFU 后，没有出现固件刷新进度的界面. A: 尝试使用特殊更新方法更新</li>
<li>Q: 我不小心进入了 DFU 模式，要怎么退出呢？A: 等待 90 秒后，DFU 模式会自动退出</li>
</ol>
<h2><a href="#更新USB固件" name="更新USB固件" target="_self" class="anchor"><span class="header-link">#</span></a>&nbsp;更新 USB 固件</h2>
<h3><a href="#更新警告" name="更新警告" target="_self" class="anchor"><span class="header-link">#</span></a>&nbsp;更新警告</h3>
<ul>
<li><strong>刷入不正确的 USB 固件可能使你的键盘的 USB 功能工作不正常</strong></li>
<li>请在更新前确认此固件是由可信的人员提供的。</li>
<li>请在更新前阅读固件发布页面的详细说明，了解可能出现的问题；</li>
<li>若在更新完毕后发现 USB 功能不可用，可以参考下面的刷新说明重新刷新。</li>
</ul>
<h3><a href="#更新方法" name="更新方法" target="_self" class="anchor"><span class="header-link">#</span></a>&nbsp;更新方法</h3>
<ol>
<li>至 WCH 官网下载<a href="http://www.wch.cn/downloads/WCHISPTool_Setup_exe.html">固件更新工具</a><sup class="footnote-ref"><a href="#fn2" id="fnref2" target="_self">[2]</a></sup></li>
<li>打开固件更新工具，切换至 “8 位 ch55x 系列”，将芯片型号改为“CH552”，并在底下的“用户程序文件中” 选择你要更新的 USB 固件</li>
<li>参考产品说明，<strong>进入 USB ISP 模式</strong>，此时，设备列表中会出现一个可选择的设备并会自动选中。</li>
<li>点击下载按钮。下载完毕后，将键盘的 USB 断开并重新连接，即可升级完毕。</li>
</ol>
<div class='last-update'>此页面最后更新于: 2019-11-28 11:28:48</div>
<hr class="footnotes-sep" />
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1"  class="footnote-item"><p>可以到 <a href="http://www.nordicsemi.com/eng/Products/Nordic-mobile-Apps/nRF-Connect-for-mobile-previously-called-nRF-Master-Control-Panel">官方下载页面</a> 或者应用商店搜索下载。支持 IOS 和安卓端。 <a href="#fnref1" class="footnote-backref" target="_self">↩</a></p>
</li>
<li id="fn2"  class="footnote-item"><p>可以使用<a href="http://www.wch.cn/downloads/WCHISPTool_Setup_exe.html">官方的固件更新工具</a>。若你在使用 Linux，则可以使用三方的<a href="https://github.com/rgwan/librech551">WCHISP</a>来更新。 <a href="#fnref2" class="footnote-backref" target="_self">↩</a></p>
</li>
</ol>
</section>
</div>
<div class="space-bottom"></div>
</div>
<div class="mui-container-fluid mui-col-sm-10 mui-col-sm-offset-1">
<div class="row mui-panel">
<div id="vcomments" class="cloud-tie-wrapper"></div>
</div>
</div>
</div>
<script>
    function generateTOC() {
        let article = document.getElementById("article");
        let tocNode = fillTOC(parseDoc(article));
        document.getElementById("toc").appendChild(tocNode);
        document.getElementById("toc-hide").onclick = function(){
            tocNode.classList.toggle("mui--hide");
            return false;
        }
    }

    function parseDoc(article) {
        let titleList = [];
        let parse = function parseLinkNode(layer, nd) {
            let link = nd.firstChild;
            if (link.nodeName.toLowerCase() == "a") {
                let href = link.getAttribute("href");
                let name = nd.childNodes[1].data.trim();
                return { layer, href, name };
            }
        };
        article.childNodes.forEach(function (nd) {
            let regExp = /h(\d)/gi;
            let result = regExp.exec(nd.nodeName.toLowerCase())
            if (result != null) {
                titleList.push(parse(result[1], nd));
            }
        });
        return titleList;
    }

    function fillTOC(titleList) {
        var list = document.createElement("div");
        var listIndex = 0;
        var currentNodeSpace = list;
        var lastNode = list;

        titleList.forEach(function (elememt) {
            // create inner layer
            while (elememt.layer > listIndex) {
                let cld = document.createElement("ul");
                if (lastNode == null)  lastNode = currentNodeSpace;
                lastNode.appendChild(cld);
                currentNodeSpace = cld;
                lastNode = null;
                listIndex++;
            }
            // jump out
            while (elememt.layer < listIndex) {
                currentNodeSpace = currentNodeSpace.parentNode;
                if (currentNodeSpace.tagName.toLocaleLowerCase() == "li") currentNodeSpace = currentNodeSpace.parentNode;
                listIndex--;
            }
            lastNode = document.createElement("li");
            // create list element
            let a = document.createElement("a");
            a.innerText = elememt.name;
            a.href = elememt.href;
            lastNode.appendChild(a);
            currentNodeSpace.appendChild(lastNode);
        });
        return list;
    }
    generateTOC();
</script><footer id="footer">
    <div class="mui-container-fluid">
        Lotlab Wiki 正在使用 <a href="https://github.com/phoenixlzx/MinoriWiki" target="_blank">MinoriWiki</a>
    </div>
</footer>

<script>
    hljs.initHighlightingOnLoad();

    let tables = document.getElementsByTagName("table");
    for(let i=0;i<tables.length;i++) {
        tables[i].classList.add("mui-table","mui-table--bordered");
    }

    var sidedrawer = document.getElementById("sidedrawer");

    document.getElementsByClassName("js-show-sidedrawer")[0].onclick = showSideDrawer;
    document.getElementsByClassName("js-hide-sidedrawer")[0].onclick = hideSideDrawer;

    let foldEls = document.getElementsByClassName("fold");
    for (let i = 0; i < foldEls.length; i++) {
        let sb = foldEls[i].nextElementSibling;
        if (sb != undefined) {
            sb.classList.add("mui--hide");
            foldEls[i].onclick = foldElementHandler;
        }
    }

    function showSideDrawer() {
        var options = {
            onclose: function() {
                sidedrawer.classList.remove("active");
                document.body.append(sidedrawer);
                $sidedrawerEl
                    .removeClass('active')
                    .appendTo(document.body);
            }
        };
        let overlayEl = mui.overlay('on', options);
        overlayEl.append(sidedrawer);
        setTimeout(function() {
            sidedrawer.classList.add("active");
        }, 20);
    }

    function hideSideDrawer() {
        document.body.classList.toggle("hide-sidedrawer");
    }

    function foldElementHandler(ev) {
        ev.target.nextElementSibling.classList.toggle("mui--hide");
    }
</script>

<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script>
new Valine({
	el: '#vcomments',
	appId: 'LxTBCCGY8s9s0U2QVIaudxk1-MdYXbMMI',
	appKey: 'PdPA1xgzmFdUQqugmfzYamF9',
	placeholder: '写下你的评论吧',
	visitor: true})
</script>

</body>
</html>